<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>åŒç«¯ diff ç®—æ³• | Desain</title>
    <meta name="description" content="Desainçš„ä¸ªäººåšå®¢ï¼Œè®°å½•å­¦ä¹ ç¬”è®°ï¼Œå‰ç«¯ç›¸å…³çŸ¥è¯†ï¼Œé«˜é¢‘é¢è¯•é¢˜ï¼Œä¸ªäººé¢ç»ç­‰">
    <link rel="preload stylesheet" href="/assets/style.2abe44cb.css" as="style">
    
    <script type="module" src="/assets/app.3bb5ea8a.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.59c3ae61.js">
    <link rel="modulepreload" href="/assets/chunks/theme.bd953a0d.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-060e9a0e.c1ddcfb3.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-23e30ac7.5ca0465f.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-586230f7.7f5f3cd9.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-96f6e417.2c4527ef.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-1476080d.c72b5860.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-4bd7e5ed.a9fd5dc7.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-12c593c2.fe4b4be4.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-6cdb9dc1.76f83d1c.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-ddc12d4e.e4048081.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-30be3ce3.68b26316.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-25e2353a.3fde064c.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-50a13b48.7bb60493.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-3bf7b8a0.c62fe25a.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-eb70e1ce.dcff4904.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-d433c073.95e1ffc6.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-bd53a0e6.662d39f9.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-7a16b501.2ac4e9d6.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-d8415767.2913ced1.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-814021a8.612ab6fa.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.ade1a5ba.js">
    <link rel="modulepreload" href="/assets/interview_vue_åŒç«¯diffç®—æ³•.md.bdedc0c1.lean.js">
    <meta name="theme-color" content="#ffffff">
    <link rel="icon" href="/favicon.ico" type="image/png">
    <link rel="alternate icon" href="/favicon.ico" type="image/png" sizes="16x16">
    <meta name="author" content="Desain">
    <link rel="mask-icon" href="/favicon.ico" color="#ffffff">
    <link rel="apple-touch-icon" href="/favicon.ico" sizes="180x180">
    <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
    <script>LA.init({id:"Jgmg5avjAUvoyePS",ck:"Jgmg5avjAUvoyePS",hashMode:!0});</script>
    <script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(r=>{r.forEach(e=>e.unregister())});</script>
    <script charset="UTF-8" id="live2d" src="https://fastly.jsdelivr.net/gh/Desain7/live2d-widget@latest/autoload.js"></script>
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a35a5a44 data-v-e588d17a><!--[--><!----><!--[--><div class="theme-blog-popover" style="display:none;" data-pagefind-ignore="all" data-v-f475c82d><div class="header" data-v-f475c82d><div class="title-wrapper" data-v-f475c82d><i class="el-icon" style="font-size:20px;" data-v-f475c82d><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-f475c82d><path fill="currentColor" d="M288 128h608L736 384l160 256H288v320h-96V64h96v64z"></path></svg><!--]--></i><span class="title" data-v-f475c82d>å…¬å‘Š</span></div><i class="el-icon close-icon" style="font-size:20px;" data-v-f475c82d><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-f475c82d><path fill="currentColor" d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"></path></svg><!--]--></i></div><div class="body content" data-v-f475c82d><!--[--><p style="" data-v-f475c82d>æ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™</p><img src="http://oss.desain7.top/piclst.gif" style="" data-v-f475c82d><!--]--><!----></div><div class="footer content" data-v-f475c82d><!--[--><!--]--></div></div><div class="theme-blog-popover-close" style="" data-v-f475c82d><i class="el-icon" style="font-size:20px;" data-v-f475c82d><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" data-v-f475c82d><path fill="currentColor" d="M288 128h608L736 384l160 256H288v320h-96V64h96v64z"></path></svg><!--]--></i></div><!--]--><!--]--><!--[--><span tabindex="-1" data-v-314c0df2></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-314c0df2> Skip to content </a><!--]--><!----><header class="VPNav" data-v-e588d17a data-v-be0b5509><div class="VPNavBar has-sidebar" data-v-be0b5509 data-v-fd0689d4><div class="container" data-v-fd0689d4><div class="title" data-v-fd0689d4><div class="VPNavBarTitle has-sidebar" data-v-fd0689d4 data-v-9681ec3e><a class="title" href="/" data-v-9681ec3e><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-f59fd28b><!--]--><!--[-->Desain<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-fd0689d4><div class="curtain" data-v-fd0689d4></div><div class="content-body" data-v-fd0689d4><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-fd0689d4><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-fd0689d4 data-v-c2e62b05><span id="main-nav-aria-label" class="visually-hidden" data-v-c2e62b05>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-c2e62b05 data-v-58f3b978><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-58f3b978><span class="text" data-v-58f3b978><!----><span data-v-58f3b978>é¢è¯•é¢˜</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-58f3b978><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-58f3b978><div class="VPMenu" data-v-58f3b978 data-v-2cfaad18><div class="items" data-v-2cfaad18><!--[--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/interview/html/" data-v-56f740db><!--[-->html<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/interview/js/" data-v-56f740db><!--[-->javascript<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/interview/vue/" data-v-56f740db><!--[-->vue<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/interview/ç®—æ³•/" data-v-56f740db><!--[-->ç®—æ³•<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/interview/è®¡ç®—æœºç½‘ç»œ/" data-v-56f740db><!--[-->è®¡ç®—æœºç½‘ç»œ<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-c2e62b05 data-v-58f3b978><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-58f3b978><span class="text" data-v-58f3b978><!----><span data-v-58f3b978>æ‰‹æ’•ä»£ç </span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-58f3b978><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-58f3b978><div class="VPMenu" data-v-58f3b978 data-v-2cfaad18><div class="items" data-v-2cfaad18><!--[--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/coding/css/" data-v-56f740db><!--[-->css<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/coding/js/" data-v-56f740db><!--[-->javascript<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-2cfaad18 data-v-56f740db><a class="VPLink link" href="/coding/algorithm/" data-v-56f740db><!--[-->ç®—æ³•ä¸æ•°æ®ç»“æ„<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-fd0689d4 data-v-92214eb1><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-92214eb1 data-v-088576a4 data-v-746634c3><span class="check" data-v-746634c3><span class="icon" data-v-746634c3><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-088576a4><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-088576a4><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-fd0689d4 data-v-f5a57811 data-v-9e590987><!--[--><a class="VPSocialLink no-icon" href="https://desain7.top/feed.rss" aria-label target="_blank" rel="noopener" data-v-9e590987 data-v-90d0067a><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48s48 21.49 48 48s-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634c-5.214-80.05-69.243-143.92-149.123-149.123c-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425c110.546 5.974 198.997 94.536 204.964 204.964c.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038c-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432c167.83 6.025 302.21 141.191 308.205 308.205c.232 6.449-4.978 11.787-11.432 11.787z" fill="currentColor"></path></svg></a><a class="VPSocialLink no-icon" href="https://github.com/Desain7/desain7.github.io" aria-label="github" target="_blank" rel="noopener" data-v-9e590987 data-v-90d0067a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-fd0689d4 data-v-cfc6b1fe data-v-58f3b978><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-58f3b978><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-58f3b978><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-58f3b978><div class="VPMenu" data-v-58f3b978 data-v-2cfaad18><!----><!--[--><!--[--><!----><div class="group" data-v-cfc6b1fe><div class="item appearance" data-v-cfc6b1fe><p class="label" data-v-cfc6b1fe>Appearance</p><div class="appearance-action" data-v-cfc6b1fe><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-cfc6b1fe data-v-088576a4 data-v-746634c3><span class="check" data-v-746634c3><span class="icon" data-v-746634c3><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-088576a4><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-088576a4><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-cfc6b1fe><div class="item social-links" data-v-cfc6b1fe><div class="VPSocialLinks social-links-list" data-v-cfc6b1fe data-v-9e590987><!--[--><a class="VPSocialLink no-icon" href="https://desain7.top/feed.rss" aria-label target="_blank" rel="noopener" data-v-9e590987 data-v-90d0067a><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48s48 21.49 48 48s-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634c-5.214-80.05-69.243-143.92-149.123-149.123c-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425c110.546 5.974 198.997 94.536 204.964 204.964c.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038c-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432c167.83 6.025 302.21 141.191 308.205 308.205c.232 6.449-4.978 11.787-11.432 11.787z" fill="currentColor"></path></svg></a><a class="VPSocialLink no-icon" href="https://github.com/Desain7/desain7.github.io" aria-label="github" target="_blank" rel="noopener" data-v-9e590987 data-v-90d0067a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-fd0689d4 data-v-c4b9d28a><span class="container" data-v-c4b9d28a><span class="top" data-v-c4b9d28a></span><span class="middle" data-v-c4b9d28a></span><span class="bottom" data-v-c4b9d28a></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-e588d17a data-v-c4ac43f0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-c4ac43f0><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-c4ac43f0><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-c4ac43f0>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-c4ac43f0 data-v-32d7685e><button data-v-32d7685e>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-e588d17a data-v-95e48966><div class="curtain" data-v-95e48966></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-95e48966><span class="visually-hidden" id="sidebar-aria-label" data-v-95e48966> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-95e48966><div class="VPSidebarItem level-0" data-v-95e48966 data-v-63203ee5><!----><!----></div></div><!--]--><!--[--><!--[--><div class="sidebar" data-pagefind-ignore="all" data-v-a35a5a44 style="--6e032739:0px;--454109a0:0px;" data-v-a156d90b><div class="recommend" data-pagefind-ignore="all" data-v-a156d90b style="--e12e1188:0px;" data-v-3f2d316d><div class="card-header" data-v-3f2d316d><span class="title" data-v-3f2d316d>ğŸ” ç›¸å…³æ–‡ç« </span><!----></div><ol class="recommend-container" data-v-3f2d316d><!--[--><li data-v-3f2d316d><i class="num" data-v-3f2d316d>1</i><div class="des" data-v-3f2d316d><a class="el-link el-link--info is-underline title" href="/interview/vue/å¿«é€Ÿdiffç®—æ³•" data-v-3f2d316d><!--v-if--><span class="el-link__inner"><!--[-->å¿«é€Ÿ diff ç®—æ³•<!--]--></span><!--v-if--></a><div class="suffix" data-v-3f2d316d><span class="tag" data-v-3f2d316d>3å¤©å‰</span></div></div></li><li data-v-3f2d316d><i class="num" data-v-3f2d316d>2</i><div class="des" data-v-3f2d316d><a class="el-link el-link--info is-underline title current" href="/interview/vue/åŒç«¯diffç®—æ³•" data-v-3f2d316d><!--v-if--><span class="el-link__inner"><!--[-->åŒç«¯ diff ç®—æ³•<!--]--></span><!--v-if--></a><div class="suffix" data-v-3f2d316d><span class="tag" data-v-3f2d316d>2023-09-17</span></div></div></li><li data-v-3f2d316d><i class="num" data-v-3f2d316d>3</i><div class="des" data-v-3f2d316d><a class="el-link el-link--info is-underline title" href="/interview/vue/ç®€å•diffç®—æ³•" data-v-3f2d316d><!--v-if--><span class="el-link__inner"><!--[-->ç®€å• diff ç®—æ³•<!--]--></span><!--v-if--></a><div class="suffix" data-v-3f2d316d><span class="tag" data-v-3f2d316d>2023-09-14</span></div></div></li><li data-v-3f2d316d><i class="num" data-v-3f2d316d>4</i><div class="des" data-v-3f2d316d><a class="el-link el-link--info is-underline title" href="/interview/vue/Vue ä¸­çš„åŒå‘æ•°æ®ç»‘å®š" data-v-3f2d316d><!--v-if--><span class="el-link__inner"><!--[-->Vue ä¸­çš„åŒå‘æ•°æ®ç»‘å®š<!--]--></span><!--v-if--></a><div class="suffix" data-v-3f2d316d><span class="tag" data-v-3f2d316d>2023-09-12</span></div></div></li><!--]--></ol></div></div><!--]--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-e588d17a data-v-901c8d5b><div class="VPDoc has-sidebar has-aside" data-v-901c8d5b data-v-a234d43e><!--[--><!--]--><div class="container" data-v-a234d43e><div class="aside" data-v-a234d43e><div class="aside-curtain" data-v-a234d43e></div><div class="aside-container" data-v-a234d43e><div class="aside-content" data-v-a234d43e><div class="VPDocAside" data-v-a234d43e data-v-541f0cce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-541f0cce data-v-fd8359e4><div class="content" data-v-fd8359e4><div class="outline-marker" data-v-fd8359e4></div><div class="outline-title" data-v-fd8359e4>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-fd8359e4><span class="visually-hidden" id="doc-outline-aria-label" data-v-fd8359e4> Table of Contents for current page </span><ul class="root" data-v-fd8359e4 data-v-ae0acd64><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-541f0cce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a234d43e><div class="content-container" data-v-a234d43e><!--[--><!--[--><!--[--><!----><!----><!--]--><!--]--><!--]--><!----><main class="main" data-v-a234d43e><div style="position:relative;" class="vp-doc _interview_vue_%E5%8F%8C%E7%AB%AFdiff%E7%AE%97%E6%B3%95" data-v-a234d43e><div><h1 id="åŒç«¯-diff-ç®—æ³•" tabindex="-1">åŒç«¯ diff ç®—æ³• <a class="header-anchor" href="#åŒç«¯-diff-ç®—æ³•" aria-label="Permalink to &quot;åŒç«¯ diff ç®—æ³•&quot;">â€‹</a></h1><p>ç®€å• diff ç®—æ³•å·²ç»åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº† DOM æ“ä½œçš„æ¬¡æ•°ï¼Œä½†å®ƒå¯¹ DOM çš„ç§»åŠ¨æ“ä½œå¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00548.jpeg" alt=""></p><p>ä»¥ä¸Šé¢ä¸¤ç»„èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå¦‚æœä½¿ç”¨ç®€å• Diff ç®—æ³•æ¥æ›´æ–°å®ƒï¼Œä¼šå‘ç”Ÿä¸¤æ¬¡ DOM ç§»åŠ¨æ“ä½œã€‚</p><ul><li>å°† p-1 ç§»åŠ¨åˆ° p-3 åé¢</li><li>å°† p-2 ç§»åŠ¨åˆ° p-1 åé¢</li></ul><p>ä¸Šé¢è¿™ç§æ›´æ–°è¿‡ç¨‹å¹¶éæœ€ä¼˜è§£ã€‚å®é™…ä¸Šï¼Œåªè¦æŠŠ p-3 ç§»åŠ¨åˆ° p-1 å‰é¢å°±å¯ä»¥å®Œæˆæ›´æ–°ï¼Œåªéœ€è¦å®Œæˆä¸€æ¬¡ DOM ç§»åŠ¨æ“ä½œã€‚ä½†ç®€å• Diff ç®—æ³•å¹¶ä¸èƒ½åšåˆ°è¿™æ ·çš„æ›´æ–°ï¼Œéœ€è¦ä½¿ç”¨åŒç«¯ Diff ç®—æ³•ã€‚</p><h2 id="åŒç«¯-diff-ç®—æ³•çš„åŸç†" tabindex="-1">åŒç«¯ Diff ç®—æ³•çš„åŸç† <a class="header-anchor" href="#åŒç«¯-diff-ç®—æ³•çš„åŸç†" aria-label="Permalink to &quot;åŒç«¯ Diff ç®—æ³•çš„åŸç†&quot;">â€‹</a></h2><p><strong>åŒç«¯ Diff ç®—æ³•</strong>æ˜¯ä¸€ç§åŒæ—¶å¯¹æ–°æ—§ä¸¤ç»„å­èŠ‚ç‚¹çš„ä¸¤ä¸ªç«¯ç‚¹è¿›è¡Œæ¯”è¾ƒçš„ç®—æ³•ã€‚å› æ­¤ï¼Œéœ€è¦å››ä¸ªç´¢å¼•å€¼ï¼Œåˆ†åˆ«æŒ‡å‘æ–°æ—§ä¸¤ç»„å­èŠ‚ç‚¹çš„ç«¯ç‚¹ã€‚</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00550.jpeg" alt=""></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">patchChildren</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">n1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">n2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">container</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isArray</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// å°è£… patchKeyedChildren å‡½æ•°å¤„ç†ä¸¤ç»„å­èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patchKeyedChildren</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">n1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">11</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">patchKeyedChildren</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">n1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">n2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">container</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å››ä¸ªç´¢å¼•å€¼</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>é€šè¿‡è¿™å››ä¸ªç´¢å¼•å€¼ï¼Œå°±å¯ä»¥æ‰¾åˆ°å®ƒä»¬æ‰€æŒ‡å‘çš„è™šæ‹ŸèŠ‚ç‚¹äº†ã€‚</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">patchKeyedChildren</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">n1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">n2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">container</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å››ä¸ªç´¢å¼•å€¼</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å››ä¸ªç´¢å¼•æŒ‡å‘çš„ vnode èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>æœ‰äº†æ–°æ—§å­èŠ‚ç‚¹ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯åï¼Œå°±å¯ä»¥è¿›è¡ŒåŒç«¯æ¯”è¾ƒäº†ã€‚</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00551.jpeg" alt=""></p><p>å¯¹äºä¸Šé¢è¿™ç§æƒ…å†µï¼Œ<strong>åŒç«¯æ¯”è¾ƒçš„å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</strong></p><ol><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„<em>ç¬¬ä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-1 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„<em>ç¬¬ä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-4ï¼Œç”±äºä¸¤è€… key å€¼ä¸åŒï¼Œå› æ­¤ä¸å¯å¤ç”¨ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„<em>æœ€åä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-4 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„<em>æœ€åä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-3ã€‚ç”±äºä¸¤è€… key å€¼ä¸åŒï¼Œå› æ­¤ä¸å¯å¤ç”¨ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„<em>ç¬¬ä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-1 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„<em>æœ€åä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-3ï¼Œç”±äºä¸¤è€… key å€¼ä¸åŒï¼Œå› æ­¤ä¸å¯å¤ç”¨ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„<em>æœ€åä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-4 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„<em>ç¬¬ä¸€ä¸ª</em>å­èŠ‚ç‚¹ p-3ï¼Œç”±äºä¸¤è€… key å€¼ç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œ DOM å¤ç”¨ã€‚</p></li></ol><p>åœ¨ç¬¬å››æ­¥ä¸­ï¼Œæ‰¾åˆ°äº†ç›¸åŒçš„èŠ‚ç‚¹ï¼Œè¯´æ˜å®ƒä»¬å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹å¯ä»¥å¤ç”¨ã€‚å¯¹äºè¿™ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåªéœ€è¦é€šè¿‡ DOM ç§»åŠ¨æ“ä½œå®Œæˆæ›´æ–°å³å¯ã€‚</p><p>æ—§å­èŠ‚ç‚¹ä¸­çš„æœ€åä¸€ä¸ªå­èŠ‚ç‚¹å’Œæ–°å­èŠ‚ç‚¹ä¸­çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ç›¸åŒï¼Œè¯´æ˜ï¼š**èŠ‚ç‚¹ p-4 åŸæœ¬æ˜¯æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œä½†åœ¨æ–°çš„é¡ºåºä¸­ï¼Œå®ƒå˜æˆé›¶ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚**ä¹Ÿå°±æ˜¯è¯´ï¼ŒèŠ‚ç‚¹ p-4 åœ¨æ›´æ–°åä¼šå˜æˆç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚<strong>å¯ä»¥å°†ç´¢å¼• oldEndIdx æŒ‡å‘çš„è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå® DOM ç§»åŠ¨åˆ°ç´¢å¼• oldStartIdx æŒ‡å‘çš„è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå® DOM å‰ã€‚</strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">patchKeyedChildren</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">n1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">n2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">container</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">children</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å››ä¸ªç´¢å¼•å€¼</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å››ä¸ªç´¢å¼•æŒ‡å‘çš„ vnode èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">14</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç¬¬ä¸€æ­¥ï¼šoldStartVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç¬¬äºŒæ­¥ï¼šoldEndVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç¬¬ä¸‰æ­¥ï¼šoldStartVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">21</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç¬¬å››æ­¥ï¼šoldEndVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ä»ç„¶éœ€è¦è°ƒç”¨ patch å‡½æ•°è¿›è¡Œæ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">24</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">25</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç§»åŠ¨ DOM æ“ä½œ</span></span>
<span class="line"><span style="color:#F78C6C;">26</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// oldEndVNode.el ç§»åŠ¨åˆ° oldStartVNode.el å‰é¢</span></span>
<span class="line"><span style="color:#F78C6C;">27</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">28</span></span>
<span class="line"><span style="color:#F78C6C;">29</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç§»åŠ¨ DOM å®Œæˆåï¼Œæ›´æ–°ç´¢å¼•å€¼ï¼Œå¹¶æŒ‡å‘ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">30</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">31</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">32</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">33</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>åœ¨ç¬¬å››æ­¥ä¸­ï¼Œæ‰¾åˆ°äº†å…·æœ‰ç›¸åŒ key å€¼çš„èŠ‚ç‚¹ã€‚è¿™è¯´æ˜ï¼ŒåŸæ¥å¤„äºå°¾éƒ¨çš„èŠ‚ç‚¹åœ¨æ–°çš„é¡ºåºä¸­åº”è¯¥å¤„äºå¤´éƒ¨ã€‚</p><p>æ‰€ä»¥åªéœ€è¦ä»¥å¤´éƒ¨å…ƒç´  oldStartVNode.el ä½œä¸ºé”šç‚¹ï¼Œå°†å°¾éƒ¨å…ƒç´ oldEndVNode.el ç§»åŠ¨åˆ°é”šç‚¹å‰é¢å³å¯ã€‚</p><p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿›è¡Œ DOM çš„ç§»åŠ¨æ“ä½œä¹‹å‰ï¼Œä»ç„¶éœ€è¦è°ƒç”¨ patch å‡½æ•°åœ¨æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹ä¹‹é—´æ‰“è¡¥ä¸ã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>å½“ä¸¤ä¸ªå…·æœ‰ç›¸åŒ key å€¼çš„èŠ‚ç‚¹éœ€è¦è¿›è¡Œä½ç½®è°ƒæ•´æ—¶ï¼Œè™½ç„¶å®ƒä»¬å…·æœ‰ç›¸åŒçš„ key å€¼ï¼Œä½†å®ƒä»¬çš„å…¶ä»–å±æ€§æˆ–å­èŠ‚ç‚¹å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚å¦‚æœæ²¡æœ‰è°ƒç”¨ patch å‡½æ•°è¿›è¡Œè¡¥ä¸æ“ä½œï¼Œé‚£ä¹ˆç§»åŠ¨èŠ‚ç‚¹åï¼Œæ–°çš„ä½ç½®ä¸Šçš„èŠ‚ç‚¹å¯èƒ½ä¼šå‡ºç°ä¸ä¸€è‡´çš„çŠ¶æ€ï¼Œå¯¼è‡´æ¸²æŸ“ç»“æœä¸ç¬¦åˆé¢„æœŸã€‚</p></div><p>ç¬¬ä¸€æ­¥ DOM ç§»åŠ¨æ“ä½œå®Œæˆåï¼Œæ–°æ—§å­èŠ‚ç‚¹åŠçœŸå® DOM èŠ‚ç‚¹çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00553.jpeg" alt=""></p><p>æ­¤æ—¶çœŸå® DOM èŠ‚ç‚¹çš„é¡ºåºä¸æ–°å­èŠ‚ç‚¹çš„é¡ºåºè¿˜ä¸ä¸€è‡´ï¼Œå› ä¸º Diff ç®—æ³•è¿˜æ²¡æœ‰ç»“æŸï¼Œè¿˜éœ€è¦è¿›è¡Œä¸‹ä¸€è½®æ›´æ–°ã€‚</p><p>å°†æ›´æ–°é€»è¾‘å°è£…åˆ°ä¸€ä¸ª while å¾ªç¯ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤ä¸€ï¼šoldStartVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤äºŒï¼šoldEndVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤ä¸‰ï¼šoldStartVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤å››ï¼šoldEndVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ä»ç„¶éœ€è¦è°ƒç”¨ patch å‡½æ•°è¿›è¡Œæ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç§»åŠ¨ DOM æ“ä½œ</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// oldEndVNode.el ç§»åŠ¨åˆ° oldStartVNode.el å‰é¢</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">15</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// ç§»åŠ¨ DOM å®Œæˆåï¼Œæ›´æ–°ç´¢å¼•å€¼ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>æ¯ä¸€è½®æ›´æ–°å®Œæˆåï¼Œå››ä¸ªç´¢å¼•å€¼éƒ½ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ•´ä¸ª while å¾ªç¯æ‰§è¡Œçš„æ¡ä»¶æ˜¯ï¼š å¤´éƒ¨ç´¢å¼•å€¼å°äºç­‰äºå°¾éƒ¨ç´¢å¼•å€¼ã€‚</p><p>ç¬¬ä¸€è½®æ›´æ–°ç»“æŸåå¾ªç¯æ¡ä»¶ä»ç„¶æˆç«‹ï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¸‹ä¸€è½®æ¯”è¾ƒï¼š</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ä¹Ÿå¯ä»¥ç”¨ <strong>å¤´éƒ¨èŠ‚ç‚¹</strong> ä»£æŒ‡ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œ <strong>å°¾éƒ¨èŠ‚ç‚¹</strong> ä»£æŒ‡æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ã€‚</p></div><ol><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-1 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-2ï¼Œç”±äºä¸¤è€… key å€¼ä¸åŒï¼Œå› æ­¤ä¸å¯å¤ç”¨ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„å°¾éƒ¨èŠ‚ç‚¹ p-3 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„å°¾éƒ¨èŠ‚ç‚¹ p-3ï¼Œä¸¤è€… key å€¼ç›¸åŒï¼Œå¯ä»¥å¤ç”¨ã€‚ç”±äºä¸¤è€…ä½ç½®ä¸€è‡´ï¼Œéƒ½å¤„äºå°¾éƒ¨ï¼Œå› æ­¤ï¼Œä¸éœ€è¦å¯¹çœŸå® DOM è¿›è¡Œç§»åŠ¨ï¼Œåªéœ€è¦æ‰“è¡¥ä¸å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p></li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤ä¸€ï¼šoldStartVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤äºŒï¼šoldEndVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// èŠ‚ç‚¹åœ¨æ–°çš„é¡ºåºä¸­ä»ç„¶å¤„äºå°¾éƒ¨ï¼Œä¸éœ€è¦ç§»åŠ¨ï¼Œä½†ä»éœ€æ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ›´æ–°ç´¢å¼•å’Œå¤´å°¾éƒ¨èŠ‚ç‚¹å˜é‡</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤ä¸‰ï¼šoldStartVNode å’Œ newEndVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ­¥éª¤å››ï¼šoldEndVNode å’Œ newStartVNode æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>è¿™ä¸€è½®æ›´æ–°å®Œæˆåï¼Œæ–°æ—§å­èŠ‚ç‚¹ä¸çœŸå® DOMèŠ‚ç‚¹çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00555.jpeg" alt=""></p><p>çœŸå® DOM çš„é¡ºåºç›¸æ¯”ä¸Šä¸€è½®æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºè¿™ä¸€è½®æ²¡æœ‰å¯¹ DOM èŠ‚ç‚¹è¿›è¡Œç§»åŠ¨ï¼Œåªå¯¹ p-3 èŠ‚ç‚¹è¿›è¡Œæ‰“è¡¥ä¸çš„æ“ä½œã€‚</p><p>ç´§æ¥ç€ï¼Œè¿›è¡Œç¬¬ä¸‰è½®çš„æ¯”è¾ƒï¼š</p><ol><li><p>æ¯”è¾ƒæ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-1 ä¸æ–°çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-2ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦ç›¸åŒã€‚ç”±äºä¸¤è€…çš„key å€¼ä¸åŒï¼Œä¸å¯å¤ç”¨ï¼Œå› æ­¤ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>æ¯”è¾ƒæ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å°¾éƒ¨èŠ‚ç‚¹ p-2 ä¸æ–°çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å°¾éƒ¨èŠ‚ç‚¹ p-1ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦ç›¸åŒï¼Œç”±äºä¸¤è€…çš„key å€¼ä¸åŒï¼Œä¸å¯å¤ç”¨ï¼Œå› æ­¤ä»€ä¹ˆéƒ½ä¸åšã€‚</p></li><li><p>ï¼šæ¯”è¾ƒæ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-1 ä¸æ–°çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å°¾éƒ¨èŠ‚ç‚¹ p-1ã€‚ä¸¤è€…çš„ key å€¼ç›¸åŒï¼Œå¯ä»¥å¤ç”¨ã€‚</p></li></ol><p>åœ¨ç¬¬ä¸‰æ­¥çš„æ¯”è¾ƒä¸­ï¼Œæ‰¾åˆ°äº†ç›¸åŒçš„èŠ‚ç‚¹ï¼Œè¯´æ˜ï¼š<strong>èŠ‚ç‚¹ p-1 åŸæœ¬æ˜¯å¤´éƒ¨èŠ‚ç‚¹ï¼Œä½†åœ¨æ–°çš„é¡ºåºä¸­ï¼Œå®ƒå˜æˆäº†å°¾éƒ¨èŠ‚ç‚¹ã€‚</strong></p><p>å› æ­¤ï¼Œéœ€è¦å°†èŠ‚ç‚¹ p-1 å¯¹åº”çš„çœŸå® DOM ç§»åŠ¨åˆ°æ—§å­èŠ‚ç‚¹çš„å°¾éƒ¨èŠ‚ç‚¹ p-2 å¯¹åº”çš„çœŸå® DOM åé¢ï¼Œå¹¶æ›´æ–°ç´¢å¼•ã€‚</p><p>æœ¬è½®æ¯”è¾ƒç»“æŸåï¼Œä¸¤ç»„èŠ‚ç‚¹åŠçœŸå® DOM çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00555.jpeg" alt=""></p><p>è¿™ä¸€æ­¥çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨ patch å‡½æ•°åœ¨ oldStartVNode å’Œ newEndVNode ä¹‹é—´æ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// å°†æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹ oldStartVNode.el ç§»åŠ¨åˆ°</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹çš„å°¾éƒ¨èŠ‚ç‚¹å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹åé¢</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">nextSibling</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ›´æ–°ç›¸å…³ç´¢å¼•åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">19</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">21</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>å¦‚æœæ—§å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹ä¸æ–°å­èŠ‚ç‚¹çš„å°¾éƒ¨èŠ‚ç‚¹åŒ¹é…ï¼Œåˆ™è¯´æ˜è¯¥æ—§èŠ‚ç‚¹æ‰€å¯¹åº”çš„çœŸå®DOM èŠ‚ç‚¹éœ€è¦ç§»åŠ¨åˆ°å°¾éƒ¨ã€‚</p><p>å› æ­¤ï¼Œéœ€è¦è·å–å½“å‰å°¾éƒ¨èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ä½œä¸ºé”šç‚¹ï¼Œå³oldEndVNode.el.nextSiblingã€‚æœ€åï¼Œæ›´æ–°ç›¸å…³ç´¢å¼•åˆ°ä¸‹ä¸€ä¸ªä½ç½®ã€‚</p><p>å½“å‰æ–°æ—§å­èŠ‚ç‚¹çš„å¤´éƒ¨ç´¢å¼•å’Œå°¾éƒ¨ç´¢å¼•å‘ç”Ÿé‡åˆï¼Œä½†ä»æ»¡è¶³å¾ªç¯çš„æ¡ä»¶ï¼Œæ‰€ä»¥è¿˜ä¼šè¿›è¡Œä¸‹ä¸€è½®çš„æ›´æ–°ã€‚</p><ol><li>æ¯”è¾ƒæ—§å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-2 ä¸æ–°å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹ p-2ã€‚å‘ç°ä¸¤è€… key å€¼ç›¸åŒï¼Œå¯ä»¥å¤ç”¨ã€‚ä½†ä¸¤è€…åœ¨æ–°æ—§ä¸¤ç»„å­èŠ‚ç‚¹ä¸­éƒ½æ˜¯å¤´éƒ¨èŠ‚ç‚¹ï¼Œå› æ­¤ä¸éœ€è¦ç§»åŠ¨ï¼Œåªéœ€è¦è°ƒç”¨ patch å‡½æ•°è¿›è¡Œæ‰“è¡¥ä¸å³å¯ã€‚</li></ol><p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// è°ƒç”¨ patch å‡½æ•°åœ¨ oldStartVNode ä¸ newStartVNode ä¹‹é—´æ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// æ›´æ–°ç›¸å…³ç´¢å¼•ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">nextSibling</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">15</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">21</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">24</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">25</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>è¿™ä¸€è½®æ›´æ–°åï¼Œæ–°æ—§å­èŠ‚ç‚¹åŠçœŸå® DOM èŠ‚ç‚¹çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00556.jpeg" alt=""></p><h2 id="éç†æƒ³çŠ¶å†µçš„å¤„ç†æ–¹å¼" tabindex="-1">éç†æƒ³çŠ¶å†µçš„å¤„ç†æ–¹å¼ <a class="header-anchor" href="#éç†æƒ³çŠ¶å†µçš„å¤„ç†æ–¹å¼" aria-label="Permalink to &quot;éç†æƒ³çŠ¶å†µçš„å¤„ç†æ–¹å¼&quot;">â€‹</a></h2><p>åŒç«¯ Diff ç®—æ³•çš„æ¯ä¸€è½®æ¯”è¾ƒçš„è¿‡ç¨‹éƒ½åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼Œä½†æ¯ä¸€è½®æ¯”è¾ƒä¸å¯èƒ½éƒ½ä¼šå‘½ä¸­å››ä¸ªæ­¥éª¤ä¸­çš„ä¸€ä¸ªï¼Œè¿™æ˜¯éå¸¸ç†æƒ³çš„æƒ…å†µã€‚</p><p>ä»¥ä¸‹é¢è¿™ç»„èŠ‚ç‚¹ä¸ºä¾‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00563.jpeg" alt=""></p><p>å½“æŒ‰ç…§åŒç«¯ Diff ç®—æ³•çš„æ€è·¯å¯¹å®ƒä»¬è¿›è¡Œç¬¬ä¸€è½®æ¯”è¾ƒæ—¶ï¼Œä¼šå‘ç°æ— æ³•å‘½ä¸­å››ä¸ªæ­¥éª¤ä¸­çš„ä»»ä½•ä¸€æ­¥ã€‚</p><p>æ­¤æ—¶ï¼Œåªèƒ½é€šè¿‡åªèƒ½åŠ é¢å¤–çš„å¤„ç†æ­¥éª¤æ¥å¤„ç†è¿™ç§éç†æƒ³æƒ…å†µã€‚å¤´å°¾çš„å››ä¸ªèŠ‚ç‚¹éƒ½æ²¡æœ‰å¯å¤ç”¨çš„èŠ‚ç‚¹ï¼Œå°±åº”è¯¥å°è¯•éå¤´å°¾çš„èŠ‚ç‚¹èƒ½å¦å¤ç”¨ã€‚</p><p>å…·ä½“åšæ³•ä¸ºï¼Œåœ¨æ—§å­èŠ‚ç‚¹ä¸­å¯»æ‰¾æ–°å­èŠ‚ç‚¹çš„å¤´éƒ¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// éå†æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œè¯•å›¾å¯»æ‰¾ä¸ newStartVNode æ‹¥æœ‰ç›¸åŒ key å€¼çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// idxInOld å°±æ˜¯æ–°çš„ä¸€ç»„å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹åœ¨æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„ç´¢å¼•</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">     </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findIndex</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">     )</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00564.jpeg" alt=""></p><p>å½“æ‹¿æ–°å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹ p-2 åœ¨æ—§å­èŠ‚ç‚¹ä¸­å¯»æ‰¾æ—¶ï¼Œå‘ç°å¯å¤ç”¨çš„èŠ‚ç‚¹åœ¨ç´¢å¼•ä¸º 1 çš„ä½ç½®ã€‚</p><p>è¯´æ˜èŠ‚ç‚¹ p-2 åŸæœ¬ä¸æ˜¯å¤´éƒ¨èŠ‚ç‚¹ï¼Œä½†åœ¨æ›´æ–°åå®ƒåº”è¯¥å˜ä¸ºå¤´éƒ¨èŠ‚ç‚¹ã€‚</p><p>æ‰€ä»¥éœ€è¦å°†èŠ‚ç‚¹ p-2 å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹ç§»åŠ¨åˆ°æ—§å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹ p-1 å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹ä¹‹å‰ã€‚</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// éå†æ—§ childrenï¼Œè¯•å›¾å¯»æ‰¾ä¸ newStartVNode æ‹¥æœ‰ç›¸åŒ key å€¼çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findIndex</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     )</span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// idxInOld å¤§äº 0ï¼Œè¯´æ˜æ‰¾åˆ°äº†å¯å¤ç”¨çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”éœ€è¦å°†å…¶å¯¹åº”çš„çœŸå® DOM ç§»åŠ¨åˆ°å¤´éƒ¨</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// idxInOld ä½ç½®å¯¹åº”çš„ vnode å°±æ˜¯éœ€è¦ç§»åŠ¨çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">       </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// ä¸è¦å¿˜è®°é™¤ç§»åŠ¨æ“ä½œå¤–è¿˜åº”è¯¥æ‰“è¡¥ä¸</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">21</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// å°† vnodeToMove.el ç§»åŠ¨åˆ°å¤´éƒ¨èŠ‚ç‚¹ oldStartVNode.el ä¹‹å‰ï¼Œå› æ­¤ä½¿ç”¨åè€…ä½œä¸ºé”šç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// ç”±äºä½ç½® idxInOld å¤„çš„èŠ‚ç‚¹æ‰€å¯¹åº”çš„çœŸå® DOM å·²ç»ç§»åŠ¨åˆ°äº†åˆ«å¤„ï¼Œå› æ­¤å°†å…¶è®¾ç½®ä¸º undefined</span></span>
<span class="line"><span style="color:#F78C6C;">24</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined</span></span>
<span class="line"><span style="color:#F78C6C;">25</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// æœ€åæ›´æ–° newStartIdx åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">26</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">27</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">28</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">29</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ç»è¿‡ä¸Šé¢çš„æ“ä½œåï¼Œæ–°æ—§ä¸¤ç»„å­èŠ‚ç‚¹ä»¥åŠçœŸå® DOM èŠ‚ç‚¹çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00565.jpeg" alt=""></p><p>æ¥ç€ï¼ŒåŒç«¯ Diff ç®—æ³•ä¼šç»§ç»­è¿›è¡Œã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä¹‹å‰è¢«è®¾ä¸º undefined çš„èŠ‚ç‚¹ã€‚è¿™è¯´æ˜è¯¥èŠ‚ç‚¹å·²ç»è¢«å¤„ç†è¿‡äº†ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è·³è¿‡ã€‚ä¸ºæ­¤ï¼Œéœ€è¦è¡¥å……è¿™éƒ¨åˆ†é€»è¾‘çš„ä»£ç ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å¢åŠ ä¸¤ä¸ªåˆ¤æ–­åˆ†æ”¯ï¼Œå¦‚æœå¤´å°¾éƒ¨èŠ‚ç‚¹ä¸º undefinedï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹å·²ç»è¢«å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findIndex</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     )</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">       </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">21</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined</span></span>
<span class="line"><span style="color:#F78C6C;">24</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">25</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">26</span></span>
<span class="line"><span style="color:#F78C6C;">27</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">28</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="æ·»åŠ æ–°å…ƒç´ " tabindex="-1">æ·»åŠ æ–°å…ƒç´  <a class="header-anchor" href="#æ·»åŠ æ–°å…ƒç´ " aria-label="Permalink to &quot;æ·»åŠ æ–°å…ƒç´ &quot;">â€‹</a></h2><p>å½“ä¸€è½®æ¯”è¾ƒè¿‡ç¨‹ä¸­ä¸ä¼šå‘½ä¸­å››ä¸ªæ­¥éª¤ä¸­çš„ä»»ä½•ä¸€æ­¥æ—¶ï¼Œä¼šæ‹¿æ–°çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­çš„å¤´éƒ¨èŠ‚ç‚¹å»æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­å¯»æ‰¾å¯å¤ç”¨çš„èŠ‚ç‚¹ã€‚ç„¶è€Œï¼Œå¹¶ä¸ä¸€å®šèƒ½æ‰¾åˆ°ã€‚</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00571.jpeg" alt=""></p><p>å¯¹è¿™ç»„èŠ‚ç‚¹è¿›è¡Œç¬¬ä¸€è½®æ¯”è¾ƒæ—¶ï¼Œæ— æ³•æ‰¾åˆ°å¯å¤ç”¨çš„èŠ‚ç‚¹ã€‚å› ä¸ºæ—§å­èŠ‚ç‚¹ä¸­æ ¹æœ¬æ²¡æœ‰ p-4 èŠ‚ç‚¹ã€‚</p><p>è¿™è¯´æ˜èŠ‚ç‚¹ p-4 æ˜¯ä¸€ä¸ªæ–°å¢èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒæ˜¯æ–°å­èŠ‚ç‚¹ä¸­çš„å¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥ç›´æ¥å°†å®ƒæŒ‚è½½åˆ°æ—§å­èŠ‚ç‚¹çš„å¤´éƒ¨èŠ‚ç‚¹å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹å‰å³å¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å¢åŠ ä¸¤ä¸ªåˆ¤æ–­åˆ†æ”¯ï¼Œå¦‚æœå¤´å°¾éƒ¨èŠ‚ç‚¹ä¸º undefinedï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹å·²ç»è¢«å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">04</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">oldEndVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">14</span><span style="color:#F07178;">     </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">15</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">16</span><span style="color:#F07178;">     </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findIndex</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F78C6C;">17</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span></span>
<span class="line"><span style="color:#F78C6C;">18</span><span style="color:#F07178;">     )</span></span>
<span class="line"><span style="color:#F78C6C;">19</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">20</span><span style="color:#F07178;">       </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">21</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">22</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">insert</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vnodeToMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">23</span><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">idxInOld</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined</span></span>
<span class="line"><span style="color:#F78C6C;">24</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">25</span><span style="color:#F07178;">       </span><span style="color:#676E95;font-style:italic;">// å°† newStartVNode ä½œä¸ºæ–°èŠ‚ç‚¹æŒ‚è½½åˆ°å¤´éƒ¨ï¼Œä½¿ç”¨å½“å‰å¤´éƒ¨èŠ‚ç‚¹ oldStartVNode.el ä½œä¸ºé”šç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">26</span><span style="color:#F07178;">       </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">27</span><span style="color:#F07178;">     </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">28</span><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">newStartVNode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F78C6C;">29</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">30</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä¸Šé¢çš„ä»£ç è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¦‚æœé¢‘ç¹å¯¹å°¾éƒ¨èŠ‚ç‚¹è¿›è¡Œæ›´æ–°ï¼Œä¼šå¯¼è‡´ oldEndIdx å°äº oldStartIdx è€Œç»“æŸæ›´æ–°çš„è¿‡ç¨‹ã€‚</p><p>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00577.jpeg" alt=""></p><p>èŠ‚ç‚¹ p-4 ç›´æ¥åœ¨æ›´æ–°è¿‡ç¨‹ä¸­è¢«é—æ¼äº†ï¼Œæ²¡æœ‰å¾—åˆ°ä»»ä½•å¤„ç†ã€‚</p><p>ä¸ºäº†å¼¥è¡¥è¿™ä¸ªç¼ºé™·ï¼Œéœ€è¦æ·»åŠ é¢å¤–çš„å¤„ç†ä»£ç ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">04</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// å¾ªç¯ç»“æŸåæ£€æŸ¥ç´¢å¼•å€¼çš„æƒ…å†µï¼Œ</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (oldEndIdx </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oldStartIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¯´æ˜æœ‰æ–°çš„èŠ‚ç‚¹é—ç•™ï¼Œéœ€è¦æŒ‚è½½å®ƒä»¬</span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newStartIdx</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newEndIdx</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">patch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartVNode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">el</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>åœ¨ while å¾ªç¯ç»“æŸåå¢åŠ ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­ï¼Œæ£€æŸ¥å››ä¸ªç´¢å¼•å€¼çš„æƒ…å†µã€‚å¦‚æœè¿˜å­˜åœ¨æœªæŒ‚è½½çš„æ–°èŠ‚ç‚¹ï¼Œå°†å®ƒä»¬ä¸€ä¸€æŒ‚è½½åˆ° oldStartVNode å¯¹åº”çš„çœŸå® DOM èŠ‚ç‚¹å‰ã€‚</p><h2 id="ç§»é™¤ä¸å­˜åœ¨çš„å…ƒç´ " tabindex="-1">ç§»é™¤ä¸å­˜åœ¨çš„å…ƒç´  <a class="header-anchor" href="#ç§»é™¤ä¸å­˜åœ¨çš„å…ƒç´ " aria-label="Permalink to &quot;ç§»é™¤ä¸å­˜åœ¨çš„å…ƒç´ &quot;">â€‹</a></h2><p>æˆ‘ä»¬è¿˜ä¼šé‡åˆ°æ–°èŠ‚ç‚¹ä¸­çš„èŠ‚ç‚¹å°‘äºæ—§èŠ‚ç‚¹çš„æƒ…å†µï¼Œæ­¤æ—¶ï¼Œéœ€è¦ç§»é™¤å…ƒç´ ã€‚</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00578.jpeg" alt=""></p><p>å¯¹ä¸Šé¢è¿™ç»„èŠ‚ç‚¹è¿›è¡Œæ•°è½®æ›´æ–°åï¼Œæ–°æ—§ä¸¤ç»„å­èŠ‚ç‚¹ä»¥åŠçœŸå® DOM èŠ‚ç‚¹çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p><p><img src="https://res.weread.qq.com/wrepub/CB_3300028078_image00580.jpeg" alt=""></p><p>æ­¤æ—¶å˜é‡ newStartIdx çš„å€¼å¤§äºå˜é‡ newEndIdx çš„å€¼ï¼Œæ»¡è¶³æ›´æ–°åœæ­¢çš„æ¡ä»¶ï¼Œäºæ˜¯æ›´æ–°ç»“æŸã€‚</p><p>ä½†æ­¤æ—¶æ—§çš„ä¸€ç»„å­èŠ‚ç‚¹ä¸­ä»å­˜åœ¨æœªè¢«å¤„ç†çš„èŠ‚ç‚¹ï¼Œåº”è¯¥å°†å…¶ç§»é™¤ã€‚å› æ­¤ï¼Œéœ€è¦å¢åŠ é¢å¤–çš„ä»£ç æ¥å¤„ç†å®ƒï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">01</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> (oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">02</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">03</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">04</span></span>
<span class="line"><span style="color:#F78C6C;">05</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (oldEndIdx </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oldStartIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> newEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">06</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// æ·»åŠ æ–°èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F78C6C;">07</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// çœç•¥éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="color:#F78C6C;">08</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (newEndIdx </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> newStartIdx </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> oldStartIdx </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> oldEndIdx) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">09</span><span style="color:#F07178;">   </span><span style="color:#676E95;font-style:italic;">// ç§»é™¤æ“ä½œ</span></span>
<span class="line"><span style="color:#F78C6C;">10</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldStartIdx</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">oldEndIdx</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F78C6C;">11</span><span style="color:#F07178;">     </span><span style="color:#82AAFF;">unmount</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">oldChildren</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#F07178;">])</span></span>
<span class="line"><span style="color:#F78C6C;">12</span><span style="color:#F07178;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F78C6C;">13</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä¸å¤„ç†æ–°å¢èŠ‚ç‚¹ç±»ä¼¼ï¼Œåœ¨ while å¾ªç¯ç»“æŸåæ·»åŠ ä¸€ä¸ª elseif çš„åˆ†æ”¯ï¼Œç”¨æ¥å¸è½½å·²ä¸å­˜åœ¨çš„èŠ‚ç‚¹ã€‚æ­¤æ—¶ï¼Œå¤„äº oldStartIdx å’Œ oldEndIdx è¿™ä¸ªåŒºé—´çš„èŠ‚ç‚¹åº”è¯¥è¢«å¸è½½ã€‚</p></div></div></main><footer class="VPDocFooter" data-v-a234d43e data-v-ddf36780><!--[--><!--]--><div class="edit-info" data-v-ddf36780><div class="edit-link" data-v-ddf36780><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/Desain7/personal-blog/tree/master/packages/blogpress/interview/vue/åŒç«¯diffç®—æ³•.md" target="_blank" rel="noreferrer" data-v-ddf36780><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-ddf36780><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> å» GitHub ä¸Šç¼–è¾‘å†…å®¹<!--]--></a></div><div class="last-updated" data-v-ddf36780><p class="VPLastUpdated" data-v-ddf36780 data-v-66ab9bab>ä¸Šæ¬¡æ›´æ–°äº: <time datetime="2023-09-25T15:35:39.000Z" data-v-66ab9bab></time></p></div></div><!----></footer><!--[--><!--[--><!--[--><div class="comment" id="giscus-comment" data-pagefind-ignore="all" data-v-a35a5a44 data-v-3054aef5><div class="el-affix comment-btn" style="height:;width:;" data-v-3054aef5><div class="" style=""><!--[--><button ariadisabled="false" type="button" class="el-button el-button--primary is-plain" style="" data-v-3054aef5><i class="el-icon" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M736 504a56 56 0 1 1 0-112 56 56 0 0 1 0 112zm-224 0a56 56 0 1 1 0-112 56 56 0 0 1 0 112zm-224 0a56 56 0 1 1 0-112 56 56 0 0 1 0 112zM128 128v640h192v160l224-160h352V128H128z"></path></svg><!--]--></i><span class=""><!--[-->è¯„è®º<!--]--></span></button><!--]--></div></div><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-e588d17a data-v-8dc663f4><div class="container" data-v-8dc663f4><p class="message" data-v-8dc663f4> <img src="/footer.gif" style="margin: 0 auto;width: 50px;"/><a target="_blank" href="https://beian.miit.gov.cn/">èµ£ICPå¤‡2022002254å·-1</a></p><p class="copyright" data-v-8dc663f4>Â© 2022-present Desain</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"coding_algorithm_2023-9-9.md\":\"0bfddee3\",\"coding_algorithm_2023-9-6.md\":\"ac95b2b2\",\"coding_js_å‡½æ•°æŸ¯é‡ŒåŒ–çš„å®ç°.md\":\"054d77c6\",\"changelog.md\":\"92680dc4\",\"coding_algorithm_2023-9-11.md\":\"4f90beab\",\"coding_js_å¸¸è§çš„åœºæ™¯ç±»é—®é¢˜.md\":\"a34beafa\",\"coding_algorithm_2023-9-4.md\":\"ed0fced5\",\"coding_js_å¸¸ç”¨æ•°æ®å¤„ç†å‡½æ•°.md\":\"73cb959c\",\"coding_algorithm_2023-9-13.md\":\"4febb50e\",\"coding_js_æ‰‹å†™ callä¸apply.md\":\"7c49ca45\",\"interview_vue_ç®€å•diffç®—æ³•.md\":\"b84886da\",\"interview_vue_å¿«é€Ÿdiffç®—æ³•.md\":\"8bc89525\",\"coding_js_æµ…æ‹·è´çš„å®ç°.md\":\"c525474c\",\"coding_js_æ·±æ‹·è´çš„å®ç°.md\":\"01bd012c\",\"coding_js_èŠ‚æµ_é˜²æŠ–.md\":\"a54b0070\",\"frontend_react_codemirror_reactå®ç°åœ¨çº¿ä»£ç ç¼–è¾‘å™¨.md\":\"9b00da56\",\"index.md\":\"191813d4\",\"interview_css_css å¸¸è§å¸ƒå±€çš„å®ç°.md\":\"23c8338c\",\"interview_js_promiseç®€è¿°.md\":\"65375770\",\"interview_html_srcå’Œhrefçš„åŒºåˆ«.md\":\"a6be57d4\",\"interview_vue_vue ä¸­çš„åŒå‘æ•°æ®ç»‘å®š.md\":\"f9acbce7\",\"interview_ç®—æ³•_äºŒå‰æœç´¢æ ‘çš„å¤šç§æ“ä½œ.md\":\"84ecb164\",\"interview_è®¡ç®—æœºç½‘ç»œ_tcp çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹.md\":\"03948f41\",\"interview_è®¡ç®—æœºç½‘ç»œ_tcpã€udpçš„æ¦‚å¿µåŠç‰¹ç‚¹.md\":\"d184e0d3\",\"interview_vue_åŒç«¯diffç®—æ³•.md\":\"bdedc0c1\",\"coding_js_æ‰‹å†™promise.md\":\"3641f25b\",\"coding_js_æ‰‹å†™ç±»å‹åˆ¤æ–­å‡½æ•°.md\":\"307b4ede\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Desain\",\"description\":\"Desainçš„ä¸ªäººåšå®¢ï¼Œè®°å½•å­¦ä¹ ç¬”è®°ï¼Œå‰ç«¯ç›¸å…³çŸ¥è¯†ï¼Œé«˜é¢‘é¢è¯•é¢˜ï¼Œä¸ªäººé¢ç»ç­‰\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"blog\":{\"pagesData\":[{\"route\":\"/CHANGELOG\",\"meta\":{\"publish\":false,\"title\":\"blogpress\",\"date\":\"2023-09-25 15:35:39\",\"tag\":[],\"description\":\" 2.0.6\\n Patch Changes\\n- Updated dependencies\\n  - @desain/theme@0.1.41\\n 2.0.5\\n Patch Changes\\n- Update\",\"cover\":\"\",\"hidden\":true,\"recommend\":false}},{\"route\":\"/coding/algorithm/2023-9-11\",\"meta\":{\"isTimeLine\":true,\"title\":\"2023-9-11 ç®—æ³•æ—¥è®°\",\"date\":\"2023-09-10 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"description\":\" 1. äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šç»™ä½ ä¸€é¢—äºŒå‰æœç´¢æ ‘ï¼Œæ‰¾å‡ºå…¶ä¸­æ‰€æœ‰çš„ä¼—æ•°\\næ€è·¯ï¼š\\n- æ–¹æ³•ä¸€\\néå†è¿™æ£µäºŒå‰æ ‘ï¼Œå¹¶åœ¨è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸ª map è®°å½•ä¸‹äºŒå‰æ ‘ä¸­æ‰€æœ‰å€¼çš„å‡ºç°æ¬¡æ•°ã€‚éå†ç»“æŸåï¼Œå°† ma\",\"cover\":\"\"}},{\"route\":\"/coding/algorithm/2023-9-13\",\"meta\":{\"isTimeLine\":true,\"title\":\"2023-9-12 ç®—æ³•æ—¥è®°\",\"date\":\"2023-09-11 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"description\":\" äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šç»™ä½ ä¸€é¢—*äºŒå‰æœç´¢æ ‘*ï¼Œå‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªå€¼ï¼Œè¿”å›æ’å…¥åçš„æ ¹èŠ‚ç‚¹\\næ€è·¯ï¼šæ ¹æ®äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œåœ¨éå†æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­æ¯”è¾ƒå½“å‰èŠ‚ç‚¹çš„å€¼ä¸è¦æ’å…¥çš„å€¼çš„å¤§å°å…³ç³»ï¼Œæ‰¾åˆ°è¦\",\"cover\":\"\"}},{\"route\":\"/coding/algorithm/2023-9-4\",\"meta\":{\"isTimeLine\":true,\"title\":\"2023-9-4 ç®—æ³•æ—¥è®°\",\"date\":\"2023-09-03 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"description\":\" 1. å·¦å¶å­ä¹‹å’Œ\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šæ±‚å‡ºä¸€é¢—äºŒå‰æ ‘æ‰€æœ‰å·¦å¶å­çš„å’Œã€‚\\næ€è·¯ï¼šåˆ†åˆ«é€’å½’éå†äºŒå‰æ ‘çš„å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸æ–­åˆ¤æ–­æ¯ä¸ªå­æ ‘æ ¹èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç»“æœä¸­ï¼›æœ€åå°†ç»“æœç›¸\",\"cover\":\"\"}},{\"route\":\"/coding/algorithm/2023-9-6\",\"meta\":{\"isTimeLine\":true,\"title\":\"2023-9-6 ç®—æ³•æ—¥è®°\",\"date\":\"2023-09-05 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"description\":\" 1. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šæ ¹æ®ç»™å‡ºçš„ä¸­åºéå†åŠåç»­éå†æ•°ç»„ï¼Œæ„é€ å‡ºä¸€é¢—äºŒå‰æ ‘\\næ€è·¯ï¼š\\n1. åˆ©ç”¨é€’å½’å®ç°\\n2. æ ¹æ®ååºéå†çš„æœ€åä¸€ä¸ªæ•°ï¼ˆå½“å‰æ ¹èŠ‚ç‚¹ï¼‰ï¼Œæ¥åˆ‡å‰²ä¸­åºéå†æ•°ç»„\",\"cover\":\"\"}},{\"route\":\"/coding/algorithm/2023-9-9\",\"meta\":{\"isTimeLine\":true,\"title\":\"2023-9-9 ç®—æ³•æ—¥è®°\",\"date\":\"2023-09-08 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"ç®—æ³•æ—¥è®°\"],\"description\":\" 1. äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘å’Œä¸€ä¸ªæ•°ï¼Œåœ¨äºŒå‰æœç´¢æ ‘ä¸­æ‰¾åˆ°å¹¶è¿”å›ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ã€‚\\næ€è·¯ï¼šåˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„ç‰¹æ€§ï¼Œé€’å½’éå†ï¼Œæ‰¾åˆ°èŠ‚ç‚¹ã€‚\\nä»£ç å®ç°ï¼š\\n```js\\n * @\",\"cover\":\"\"}},{\"route\":\"/coding/js/å‡½æ•°æŸ¯é‡ŒåŒ–çš„å®ç°\",\"meta\":{\"isTimeLine\":true,\"title\":\"å‡½æ•°æŸ¯é‡ŒåŒ–çš„å®ç°\",\"date\":\"2023-09-01 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" å®ç°æ€è·¯\\n1. åˆ›å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚\\n2. åœ¨æ–°å‡½æ•°å†…éƒ¨ï¼Œä½¿ç”¨é—­åŒ…ä¿å­˜ä¼ å…¥çš„å‡½æ•°å’Œå·²ç»ä¼ å…¥çš„å‚æ•°ã€‚\\n3. åœ¨æ–°å‡½æ•°çš„ä¸»ä½“ä¸­ï¼Œåˆ¤æ–­å·²ç»ä¼ å…¥çš„å‚æ•°æ•°é‡æ˜¯å¦æ»¡è¶³åŸ\",\"cover\":\"\"}},{\"route\":\"/coding/js/å¸¸ç”¨æ•°æ®å¤„ç†å‡½æ•°\",\"meta\":{\"isTimeLine\":true,\"title\":\"å¸¸ç”¨æ•°æ®å¤„ç†å‡½æ•°\",\"date\":\"2023-09-05 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" æ—¥æœŸæ ¼å¼åŒ–å‡½æ•°\\nå°†ä¼ å…¥çš„æ ‡å‡†åŒ–æ—¥æœŸå¯¹è±¡è½¬æ¢ä¸ºæŒ‡å®šçš„æ ¼å¼\\nå®ç°ä»£ç ï¼š\\n```js\\nconst dateFormat = (dateInput, format) =\\n  // è·å–æ—¥æœŸ\\n  let da\",\"cover\":\"\"}},{\"route\":\"/coding/js/å¸¸è§çš„åœºæ™¯ç±»é—®é¢˜\",\"meta\":{\"isTimeLine\":true,\"title\":\"å¸¸è§çš„åœºæ™¯ç±»é—®é¢˜\",\"date\":\"2023-09-13 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" å¾ªç¯æ‰“å°çº¢é»„ç»¿\\nçº¢ç¯ 3s äº®ä¸€æ¬¡ï¼Œç»¿ç¯ 1s äº®ä¸€æ¬¡ï¼Œé»„ç¯ 2s äº®ä¸€æ¬¡ï¼›å¦‚ä½•è®©ä¸‰ä¸ªç¯ä¸æ–­äº¤æ›¿é‡å¤äº®ç¯ï¼Ÿ\\n å®ç°æ¯éš”ä¸€ç§’æ‰“å° 1,2,3,4\",\"cover\":\"\"}},{\"route\":\"/coding/js/æ‰‹å†™ callä¸apply\",\"meta\":{\"isTimeLine\":true,\"title\":\"æ‰‹å†™å®ç° callã€apply æ–¹æ³•\",\"date\":\"2023-08-24 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" call æ–¹æ³•å’Œ apply æ–¹æ³•çš„åŒºåˆ«\\n1. å‚æ•°ä¼ é€’æ–¹å¼ï¼š\\ncall æ–¹æ³•æ¥å—çš„å‚æ•°æ˜¯ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ä¸€ä¸€ä¼ é€’çš„ï¼Œé€šè¿‡é€—å·åˆ†éš”ã€‚\\nä¾‹å¦‚ï¼š`func.call(context, arg1, a\",\"cover\":\"\"}},{\"route\":\"/coding/js/æ‰‹å†™promise\",\"meta\":{\"isTimeLine\":true,\"title\":\"æ‰‹å†™å®ç° Promise\",\"date\":\"2023-08-24 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\"Promise ç®€è¿°\\n---\\n å®šä¹‰ä¸‰ç§çŠ¶æ€\\n* Promise çš„ä¸‰ç§çŠ¶æ€\\n  * pendingï¼ˆç­‰å¾…ï¼‰: åˆå§‹çŠ¶æ€ï¼Œæ²¡æœ‰å®Œæˆï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»\\n  * resolvedï¼ˆå®Œæˆï¼‰: è¡¨ç¤ºæ“ä½œæˆåŠŸå®Œæˆ\\n\",\"cover\":\"\"}},{\"route\":\"/coding/js/æ‰‹å†™ç±»å‹åˆ¤æ–­å‡½æ•°\",\"meta\":{\"isTimeLine\":true,\"title\":\"æ‰‹å†™ç±»å‹åˆ¤æ–­å‡½æ•°\",\"date\":\"2023-09-01 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" å®ç°æ€è·¯\\nå®ç°ä¸€ä¸ªç±»å‹åˆ¤æ–­å‡½æ•°å¯ä»¥æŒ‰ç…§ä¸‹é¢è¿™ä¸ªæ€è·¯ï¼š\\n1. é¦–å…ˆï¼Œé€šè¿‡ JavaScript æä¾›çš„åŸºæœ¬ç±»å‹åˆ¤æ–­æ–¹æ³•è¿›è¡Œåˆ¤æ–­ã€‚åŒ…æ‹¬ä½¿ç”¨ typeof æ“ä½œç¬¦åˆ¤æ–­åŸºæœ¬ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€å‡½æ•°\",\"cover\":\"\"}},{\"route\":\"/coding/js/æµ…æ‹·è´çš„å®ç°\",\"meta\":{\"isTimeLine\":true,\"title\":\"æµ…æ‹·è´çš„å®ç°\",\"date\":\"2023-09-02 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" ä»€ä¹ˆæ˜¯æµ…æ‹·è´ï¼Ÿ\\næµ…æ‹·è´æ˜¯æŒ‡å°†ä¸€ä¸ªæ–°çš„å¯¹è±¡å¯¹åŸå§‹å¯¹è±¡çš„å±æ€§å€¼è¿›è¡Œç²¾ç¡®åœ°æ‹·è´ï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ï¼Œå¦‚æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯å†…å­˜åœ°å€ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ç±»å‹å±æ€§çš„å€¼å‘\",\"cover\":\"\"}},{\"route\":\"/coding/js/æ·±æ‹·è´çš„å®ç°\",\"meta\":{\"isTimeLine\":true,\"title\":\"æ·±æ‹·è´çš„å®ç°\",\"date\":\"2023-09-03 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" ä»€ä¹ˆæ˜¯æ·±æ‹·è´ï¼Ÿ\\næ·±æ‹·è´ä¸æµ…æ‹·è´æœ€å¤§çš„ä¸åŒå°±åœ¨äºï¼Œå½“é‡åˆ°å±æ€§å€¼ä¸ºå¼•ç”¨ç±»å‹çš„æ—¶å€™ï¼Œå®ƒä¼šæ–°å»ºä¸€ä¸ªå¼•ç”¨ç±»å‹å¹¶å°†å¯¹åº”çš„å€¼å¤åˆ¶ç»™å®ƒï¼Œå› æ­¤æ–°å¯¹è±¡è·å¾—çš„ä¸€ä¸ªæ˜¯æ–°çš„å¼•ç”¨ç±»å‹è€Œä¸æ˜¯åŸæœ‰ç±»å‹çš„å¼•ç”¨ã€‚\\næ·±æ‹·è´å¯¹äºä¸€äº›å¯¹è±¡å¯\",\"cover\":\"\"}},{\"route\":\"/coding/js/èŠ‚æµ&é˜²æŠ–\",\"meta\":{\"isTimeLine\":true,\"title\":\"èŠ‚æµ&é˜²æŠ–\",\"date\":\"2023-08-23 16:00:00\",\"tags\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"categories\":[\"æ‰‹æ’•ä»£ç \"],\"tag\":[\"æ‰‹æ’•ä»£ç \",\"javascript\"],\"description\":\" èŠ‚æµ\\n* è§„å®šä¸€ä¸ªæ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…ï¼Œåªèƒ½æœ‰ä¸€æ¬¡è§¦å‘äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªæ—¶é—´å†…æŸäº‹ä»¶è¢«è§¦å‘å¤šæ¬¡ï¼Œåªæœ‰ä¸€æ¬¡èƒ½ç”Ÿæ•ˆ\\n```js\\nconst throttle = function (call\",\"cover\":\"\"}},{\"route\":\"/frontend/react/codemirror+reactå®ç°åœ¨çº¿ä»£ç ç¼–è¾‘å™¨\",\"meta\":{\"isTimeLine\":true,\"title\":\"React + Codemirror å®ç°åœ¨çº¿ä»£ç ç¼–è¾‘å™¨\",\"date\":\"2023-09-08 16:00:00\",\"tags\":[\"React\",\"å¼€å‘ç»éªŒ\"],\"categories\":[\"React\"],\"tag\":[\"React\",\"å¼€å‘ç»éªŒ\"],\"description\":\" èƒŒæ™¯\\næœ€è¿‘å¼€å‘çš„é¡¹ç›®ä¸­éœ€è¦å®ç°ä¸€ä¸ªåœ¨çº¿ä»£ç ç¼–è¾‘å™¨çš„éœ€æ±‚ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ° code-mirror\",\"cover\":\"\"}},{\"route\":\"/interview/css/css å¸¸è§å¸ƒå±€çš„å®ç°\",\"meta\":{\"isTimeLine\":true,\"title\":\"css å¸¸è§å¸ƒå±€çš„å®ç°\",\"date\":\"2023-09-23 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Css\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Css\"],\"description\":\" å•è¡Œã€å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—\\nå•è¡Œæ–‡æœ¬æº¢å‡º \\n```css\\n.single {\\n  overflow: hidden;            // æº¢å‡ºéšè—\\n  text-overflow: ellips\",\"cover\":\"\"}},{\"route\":\"/interview/html/srcå’Œhrefçš„åŒºåˆ«\",\"meta\":{\"isTimeLine\":true,\"title\":\"src å’Œ href çš„åŒºåˆ«\",\"date\":\"2023-09-18 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Html\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Html\"],\"description\":\"src å’Œ href æ˜¯ Html ä¸­ä¸¤ä¸ªå¸¸ç”¨çš„å±æ€§ï¼Œå®ƒä»¬å¸¸ç”¨äºæŒ‡å®šèµ„æºçš„ä½ç½®æˆ–é“¾æ¥ã€‚\\näºŒè€…è™½ç„¶åœ¨è¯­æ³•ä¸Šç›¸ä¼¼ï¼Œä½†åœ¨ç”¨æ³•å’ŒåŠŸèƒ½ä¸Šå­˜åœ¨å·®å¼‚ã€‚\\nä»ç”¨æ³•ä¸Šçœ‹ï¼š\\n`src` å±æ€§ç”¨äºåµŒå…¥å¤–éƒ¨èµ„æºï¼ˆæ¯”å¦‚è„šæœ¬ã€å›¾åƒ\",\"cover\":\"\"}},{\"route\":\"/interview/js/Promiseç®€è¿°\",\"meta\":{\"isTimeLine\":true,\"title\":\"Promiseçš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿä»€ä¹ˆæ˜¯Promiseé“¾ï¼ŸPromiseæ„é€ å‡½æ•°æ‰§è¡Œå’Œthenå‡½æ•°æ‰§è¡Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\",\"date\":\"2023-08-23 16:00:00\",\"tags\":[\"é¢è¯•\",\"javascript\"],\"categories\":[\"é¢è¯•\"],\"tag\":[\"é¢è¯•\",\"javascript\"],\"description\":\" ç‰¹ç‚¹\\n* Promise æœ‰ä¸‰ç§çŠ¶æ€\\n  * pendingï¼ˆç­‰å¾…ï¼‰: åˆå§‹çŠ¶æ€ï¼Œæ²¡æœ‰å®Œæˆï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»\\n  * resolvedï¼ˆå®Œæˆï¼‰: è¡¨ç¤ºæ“ä½œæˆåŠŸå®Œæˆ\\n  * rejectdeï¼ˆæ‹’ç»ï¼‰: è¡¨\",\"cover\":\"\"}},{\"route\":\"/interview/vue/Vue ä¸­çš„åŒå‘æ•°æ®ç»‘å®š\",\"meta\":{\"isTimeLine\":true,\"title\":\"Vue ä¸­çš„åŒå‘æ•°æ®ç»‘å®š\",\"date\":\"2023-09-12 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"description\":\"\",\"cover\":\"\"}},{\"route\":\"/interview/vue/åŒç«¯diffç®—æ³•\",\"meta\":{\"isTimeLine\":true,\"title\":\"åŒç«¯ diff ç®—æ³•\",\"date\":\"2023-09-17 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"description\":\"ç®€å• diff ç®—æ³•å·²ç»åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº† DOM æ“ä½œçš„æ¬¡æ•°ï¼Œä½†å®ƒå¯¹ DOM çš„ç§»åŠ¨æ“ä½œå¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚\\nä»¥ä¸Šé¢ä¸¤ç»„èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå¦‚æœä½¿ç”¨ç®€å• Diff ç®—æ³•æ¥æ›´æ–°å®ƒï¼Œä¼šå‘ç”Ÿä¸¤æ¬¡ DOM ç§»åŠ¨æ“ä½œã€‚\\n- \",\"cover\":\"https://res.weread.qq.com/wrepub/CB_3300028078_image00548.jpeg\"}},{\"route\":\"/interview/vue/å¿«é€Ÿdiffç®—æ³•\",\"meta\":{\"isTimeLine\":true,\"title\":\"å¿«é€Ÿ diff ç®—æ³•\",\"date\":\"2023-09-21 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"description\":\" ç›¸åŒçš„å‰ç½®å…ƒç´ å’Œåç½®å…ƒç´ \\næœ‰åˆ«äºç®€å• Diff ç®—æ³•å’ŒåŒç«¯ Diff ç®—æ³•ï¼Œå¿«é€Ÿ Diff ç®—æ³•åŒ…å«é¢„å¤„ç†æ­¥éª¤ï¼Œè¿™å€Ÿé‰´äº†çº¯æ–‡æœ¬ Diff ç®—æ³•çš„æ€è·¯ã€‚\\nåœ¨å¯¹ä¸¤æ®µæ–‡æœ¬è¿›è¡Œ Diff ä¹‹å‰ï¼Œå¯ä»¥å…ˆå¯¹å®ƒä»¬\",\"cover\":\"https://res.weread.qq.com/wrepub/CB_3300028078_image00584.jpeg\"}},{\"route\":\"/interview/vue/ç®€å•diffç®—æ³•\",\"meta\":{\"isTimeLine\":true,\"title\":\"ç®€å• diff ç®—æ³•\",\"date\":\"2023-09-14 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"Vue æºç è§£æ\"],\"description\":\" å‡å°‘ DOM æ“ä½œçš„æ€§èƒ½å¼€é”€\\nå¯¹äºä¸‹é¢ä¸¤ç»„è™šæ‹ŸèŠ‚ç‚¹ï¼š\\n```js\\n// æ—§ vnode\\nconst oldVNode = {\\n   type: 'div',\\n   children: [\\n     \",\"cover\":\"https://res.weread.qq.com/wrepub/CB_3300028078_image00533.jpeg\"}},{\"route\":\"/interview/ç®—æ³•/äºŒå‰æœç´¢æ ‘çš„å¤šç§æ“ä½œ\",\"meta\":{\"isTimeLine\":true,\"title\":\"äºŒå‰æœç´¢æ ‘çš„å¤šç§æ“ä½œ\",\"date\":\"2023-09-12 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"ç®—æ³•æ—¥è®°\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"ç®—æ³•æ—¥è®°\"],\"description\":\" äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ\\né¢˜ç›®åœ°å€\\né¢˜æ„ï¼šç»™ä½ ä¸€é¢—*äºŒå‰æœç´¢æ ‘*ï¼Œå‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªå€¼ï¼Œè¿”å›æ’å…¥åçš„æ ¹èŠ‚ç‚¹\\næ€è·¯ï¼šæ ¹æ®äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œåœ¨éå†æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­æ¯”è¾ƒå½“å‰èŠ‚ç‚¹çš„å€¼ä¸è¦æ’å…¥çš„å€¼çš„å¤§å°å…³ç³»ï¼Œæ‰¾åˆ°è¦\",\"cover\":\"\"}},{\"route\":\"/interview/è®¡ç®—æœºç½‘ç»œ/TCP çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹\",\"meta\":{\"isTimeLine\":true,\"title\":\"TCP çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹\",\"date\":\"2023-09-14 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"è®¡ç®—æœºç½‘ç»œ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"è®¡ç®—æœºç½‘ç»œ\"],\"description\":\" ä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ\\nä¸‰æ¬¡æ¡æ‰‹å…¶å®å°±æ˜¯æŒ‡åœ¨å»ºç«‹ä¸€æ¬¡ TCP è¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ€»å…±å‘é€ä¸‰ä¸ªåŒ…ã€‚\\nè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹çš„ä¸»è¦ä½œç”¨ï¼š\\n- ç¡®è®¤é€šä¿¡åŒæ–¹çš„æ¥æ”¶èƒ½åŠ›å’Œå‘é€èƒ½åŠ›æ˜¯å¦æ­£å¸¸ã€‚\\n- \",\"cover\":\"\"}},{\"route\":\"/interview/è®¡ç®—æœºç½‘ç»œ/TCPã€UDPçš„æ¦‚å¿µåŠç‰¹ç‚¹\",\"meta\":{\"isTimeLine\":true,\"title\":\"TCPã€UDP çš„æ¦‚å¿µåŠç‰¹ç‚¹\",\"date\":\"2023-09-12 16:00:00\",\"tags\":[\"é¢è¯•ç»éªŒ\",\"è®¡ç®—æœºç½‘ç»œ\"],\"categories\":[\"é¢è¯•ç»éªŒ\"],\"tag\":[\"é¢è¯•ç»éªŒ\",\"è®¡ç®—æœºç½‘ç»œ\"],\"description\":\"TCPã€UDP éƒ½æ˜¯ä¼ è¾“å±‚åè®®ï¼Œä»–ä»¬åŒå±äº TCP/IP åè®®æ—ã€‚åœ¨ç½‘ç»œä¸­å®ƒä»¬ç”¨äºå¤„ç†æ•°æ®åŒ…ã€‚\\nåœ¨ OSI æ¨¡å‹ä¸­ï¼Œä»–ä»¬å±äºä¼ è¾“å±‚ï¼ˆIP åè®®çš„ä¸Šä¸€å±‚ï¼‰\\n UDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰\\nUDP æ˜¯ä¸€ç§æ— è¿\",\"cover\":\"\"}}],\"RSS\":{\"title\":\"Desain\",\"baseUrl\":\"https://desain7.top\",\"description\":\"è¦ä»é‚£æ—¶èµ·ï¼Œä¸å†åŠ¨æ‘‡ï¼ˆå‰ç«¯ç›¸å…³æŠ€æœ¯åˆ†äº«ï¼‰\",\"id\":\"https://desain7.top\",\"link\":\"https://desain7.top\",\"language\":\"zh-cn\",\"image\":\"http://oss.desain7.top/pic94500053.jpg\",\"favicon\":\"http://oss.desain7.top/pic94500053.jpg\",\"copyright\":\"Copyright (c) 2022-present, Desain\",\"url\":\"https://desain7.top/feed.rss\"},\"author\":\"Desain\",\"comment\":{\"repo\":\"Desain7/desain7.github.io\",\"repoId\":\"R_kgDOKKbERQ\",\"category\":\"Announcements\",\"categoryId\":\"DIC_kwDOKKbERc4CY00O\",\"inputPosition\":\"top\"},\"popover\":{\"title\":\"å…¬å‘Š\",\"body\":[{\"type\":\"text\",\"content\":\"æ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™\"},{\"type\":\"image\",\"src\":\"http://oss.desain7.top/piclst.gif\"}],\"duration\":-1},\"search\":false,\"recommend\":{\"showSelf\":true,\"nextText\":\"ä¸‹ä¸€é¡µ\",\"style\":\"sidebar\"},\"authorList\":[{\"nickname\":\"Desain\",\"url\":\"https://github.com/Desain7\",\"des\":\"è¦ä»é‚£æ—¶èµ·ï¼Œä¸å†åŠ¨æ‘‡\"}],\"mermaid\":true},\"socialLinks\":[{\"icon\":{\"svg\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 448 512\\\"><path d=\\\"M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48s48 21.49 48 48s-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634c-5.214-80.05-69.243-143.92-149.123-149.123c-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425c110.546 5.974 198.997 94.536 204.964 204.964c.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038c-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432c167.83 6.025 302.21 141.191 308.205 308.205c.232 6.449-4.978 11.787-11.432 11.787z\\\" fill=\\\"currentColor\\\"></path></svg>\"},\"link\":\"https://desain7.top/feed.rss\"},{\"icon\":\"github\",\"link\":\"https://github.com/Desain7/desain7.github.io\"}],\"sidebar\":[{\"text\":\"\",\"items\":[]}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"3VTA3J7890\",\"apiKey\":\"2db23e72e7426d636f6858e0ce35088a\",\"indexName\":\"desain7\",\"placeholder\":\"è¯·è¾“å…¥è¦æœç´¢çš„å†…å®¹...\"}},\"lastUpdatedText\":\"ä¸Šæ¬¡æ›´æ–°äº\",\"footer\":{\"message\":\" <img src=\\\"/footer.gif\\\" style=\\\"margin: 0 auto;width: 50px;\\\"/><a target=\\\"_blank\\\" href=\\\"https://beian.miit.gov.cn/\\\">èµ£ICPå¤‡2022002254å·-1</a>\",\"copyright\":\"Â© 2022-present Desain\"},\"logo\":\"/logo.png\",\"editLink\":{\"pattern\":\"https://github.com/Desain7/personal-blog/tree/master/packages/blogpress/:path\",\"text\":\"å» GitHub ä¸Šç¼–è¾‘å†…å®¹\"},\"nav\":[{\"text\":\"é¢è¯•é¢˜\",\"items\":[{\"text\":\"html\",\"link\":\"/interview/html/\"},{\"text\":\"javascript\",\"link\":\"/interview/js/\"},{\"text\":\"vue\",\"link\":\"/interview/vue/\"},{\"text\":\"ç®—æ³•\",\"link\":\"/interview/ç®—æ³•/\"},{\"text\":\"è®¡ç®—æœºç½‘ç»œ\",\"link\":\"/interview/è®¡ç®—æœºç½‘ç»œ/\"}]},{\"text\":\"æ‰‹æ’•ä»£ç \",\"items\":[{\"text\":\"css\",\"link\":\"/coding/css/\"},{\"text\":\"javascript\",\"link\":\"/coding/js/\"},{\"text\":\"ç®—æ³•ä¸æ•°æ®ç»“æ„\",\"link\":\"/coding/algorithm/\"}]}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>